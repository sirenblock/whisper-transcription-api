# =============================================================================
# WHISPER API - ENVIRONMENT VARIABLES
# =============================================================================
# Copy this file to .env and fill in your actual values
# DO NOT commit .env to version control

# =============================================================================
# DATABASE
# =============================================================================
DATABASE_URL="postgresql://user:password@localhost:5432/whisperapi"

# =============================================================================
# REDIS
# =============================================================================
REDIS_URL="redis://localhost:6379"

# =============================================================================
# S3 / CLOUDFLARE R2 STORAGE
# =============================================================================
S3_BUCKET="whisper-audio"
S3_REGION="us-east-1"
S3_ACCESS_KEY="your_access_key_here"
S3_SECRET_KEY="your_secret_key_here"
# Optional: Only needed for Cloudflare R2
S3_ENDPOINT="https://your-account.r2.cloudflarestorage.com"

# =============================================================================
# STRIPE PAYMENT INTEGRATION (Task 9)
# =============================================================================
# Get these from: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY="sk_test_..." # Use sk_live_... for production

# Get this from: https://dashboard.stripe.com/webhooks
STRIPE_WEBHOOK_SECRET="whsec_..."

# Create products and prices in Stripe Dashboard
# PRO Plan - Fixed monthly subscription ($29/month)
STRIPE_PRICE_ID_PRO="price_..."

# PAYG Plan - Metered usage billing ($0.10/minute)
STRIPE_PRICE_ID_PAYG="price_..."

# =============================================================================
# WORKER CONFIGURATION
# =============================================================================
# Mode: "local" for Mac Mini worker, "cloud" for Modal/cloud GPU
WORKER_MODE="local"

# Local worker URL (use Tailscale IP for remote access)
LOCAL_WORKER_URL="http://100.x.x.x:3001"

# Cloud worker URL (Modal deployment URL)
CLOUD_WORKER_URL="https://modal-xxx.modal.run"

# =============================================================================
# API CONFIGURATION
# =============================================================================
# API key format: wtr_live_[32 random chars]
API_KEY_PREFIX="wtr_live_"
API_KEY_LENGTH=32

# Server configuration
PORT=3000
NODE_ENV="development" # Use "production" in production

# Frontend URL (for CORS and Stripe redirects)
FRONTEND_URL="http://localhost:3001"

# =============================================================================
# RATE LIMITS (requests per hour)
# =============================================================================
RATE_LIMIT_FREE=3
RATE_LIMIT_PRO=20
RATE_LIMIT_PAYG=100

# =============================================================================
# MONTHLY QUOTAS (minutes)
# =============================================================================
QUOTA_FREE=60
QUOTA_PRO=600
# PAYG has no quota limit

# =============================================================================
# FILE UPLOAD LIMITS
# =============================================================================
MAX_FILE_SIZE_MB=500
ALLOWED_FORMATS="mp3,wav,m4a,mp4,mpeg,webm,flac,ogg"

# =============================================================================
# FILE RETENTION
# =============================================================================
# How long to keep audio files and transcriptions in S3 (hours)
FILE_RETENTION_HOURS=24

# =============================================================================
# SECURITY
# =============================================================================
# Secret for JWT signing (if using JWT auth)
JWT_SECRET="your_random_secret_here"

# CORS allowed origins (comma-separated)
CORS_ORIGINS="http://localhost:3001,https://your-domain.com"

# =============================================================================
# MONITORING & LOGGING
# =============================================================================
# Log level: debug, info, warn, error
LOG_LEVEL="info"

# Sentry DSN for error tracking (optional)
SENTRY_DSN=""

# =============================================================================
# TESTING
# =============================================================================
# Use test Stripe keys for testing
STRIPE_TEST_MODE=true
